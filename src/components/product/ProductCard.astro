---
import { formatPrice } from '@lib/utils';
import FavoriteButton from '@components/islands/FavoriteButton';

interface Props {
  product: {
    id: string;
    name: string;
    slug: string;
    price: number;
    images: string[];
    stock: number;
  };
}

const { product } = Astro.props;
const mainImage = product.images[0] || '/placeholder.jpg';
---

<div class="group relative">
  <div class="relative overflow-hidden bg-gray-100">
    <a href={`/productos/${product.slug}`} class="block aspect-[3/4]">
      <img 
        src={mainImage} 
        alt={product.name}
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
        loading="lazy"
      />
    </a>
    
    {/* Badges */}
    {product.stock > 0 && (
       <div class="absolute bottom-2 left-2 pointer-events-none bg-black text-white text-[10px] md:text-xs font-black px-2 py-0.5 md:py-1 uppercase tracking-tighter md:tracking-wider">
         NEW
       </div>
    )}
    
    {/* Favorite Icon - Outside the anchor tag */}
    <FavoriteButton client:load productId={product.id} />
  </div>
  
  <a href={`/productos/${product.slug}`} class="block pt-2 md:pt-3">
    <h3 class="text-xs md:text-sm font-medium text-gray-700 mb-0.5 md:mb-1 leading-tight group-hover:text-black transition-colors uppercase tracking-tight">
      {product.name}
    </h3>
    <div class="flex items-center space-x-2">
      <p class="text-sm md:text-base font-black text-black">
        {formatPrice(product.price)}
      </p>
    </div>
    
    <div class="flex items-center gap-1 mt-1 md:mt-2 text-[10px] text-gray-400 uppercase font-bold tracking-widest">
      <span>+1 Color</span>
    </div>
  </a>
</div>
